(function(){var t,n,i,e,r=[].slice;i=function(t){return Array.isArray(t)?t:t.split(",").map(function(t){return t.trim()})},t=function(){function t(t){this.entity=t,this.entity.addHandler=this.addHandler.bind(this),this.handlers={}}return t.prototype.handlers=null,t.prototype.entity=null,t.prototype.warn=function(t){return console.warn("Backbone-initialize warn: "+t)},t.prototype.getChild=function(t,n,i){var e;return null==i&&(i=this.entity),e=t.shift(),null!=i[e]?t.length?this.getChild(t,n,i[e]):i[e]:(this.warn(e+" undefined (this."+n+")"),null)},t.prototype.addHandler=function(t,n,e){var r,a,o;if(null==e&&(e=this.entity),"object"==typeof t){a=[];for(r in t)o=t[r],a.push(this.addHandler(r,o,e));return a}return"object"!=typeof n||Array.isArray(n)?("string"==typeof n&&(n=i(n)),Array.isArray(n)||(n=[n]),n=n.slice(),"_"===t[0]&&(t=n.shift()),i(t).forEach(function(t){return function(i){var r,a;if(r=e,a=i.split("."),i=a.pop(),!a.length||(r=t.getChild(a,a.join("."),r)))return n.forEach(function(n){var e,a,o;if(a=!1,o=t.entity,"string"==typeof n){if(a=n,e=n.split("."),n=e.pop(),!(o=e.length?t.getChild(e,a):t.entity))return;n=o[n]}return"function"==typeof n?t.entity.listenTo(r,i,n.bind(o)):t.warn("Can't find handler for \""+i+'"'+(a?': "'+a+'"':""))})}}(this))):void i(t).forEach(function(t){return function(i){var a,o,l;if(a=t.getChild(i.split("."),i,e)){o=[];for(r in n)l=n[r],o.push(t.addHandler(r,l,a));return o}return t.warn("Can't append handlers to "+i+" cause child not found")}}(this))},t.prototype.addHandlers=function(){if(null!=this.entity.handlers&&!this.entity.disableHandlers)return this.addHandler(this.entity.handlers)},t.prototype.launch=function(){var t,n;return t=1<=arguments.length?r.call(arguments,0):[],this.addHandlers(),(n=this.entity).trigger.apply(n,["launch"].concat(r.call(t)))},t}(),this.BackbonePrepare=n=[],e=function(){var e,a,o,l,p,h,s;if(l=1<=arguments.length?r.call(arguments,0):[],o=this.options,this instanceof Backbone.Collection&&(o=l[1]),"string"==typeof this.prepare&&(this.prepare=i(this.prepare)),"object"==typeof this.handlers||null!=(null!=o?o.attach:void 0)||"function"==typeof this.launch||Array.isArray(this.prepare)){if(this._bbInitialize=new t(this),"function"==typeof this.launch&&this.addHandler("launch",this.launch),null!=(null!=o?o.attach:void 0)){h=o.attach;for(e in h)a=h[e],this[e]=a}return n.length||Array.isArray(this.prepare)?(this.prepare||(this.prepare=[]),this.prepare=n.concat(this.prepare),p=this.prepare.map(function(t){return function(n){var i;return i="function"==typeof n?n:t[n],"function"!=typeof i&&(t._bbInitialize.warn("Prepare item "+n+" isn't function"),i=$.noop),i.apply(t,l)}}(this)),this.promise=$.when.apply(null,p).then(function(t){return function(){var n;return(n=t._bbInitialize).launch.apply(n,l)}}(this))):(s=this._bbInitialize).launch.apply(s,l)}},Backbone.Model.prototype.initialize=e,Backbone.Collection.prototype.initialize=e,Backbone.View.prototype.initialize=e,null!=Backbone.NestedModel&&(Backbone.NestedModel.prototype.initialize=e),null!=Backbone.Layout&&(Backbone.Layout.prototype.initialize=e),"undefined"!=typeof Marionette&&null!==Marionette&&(Marionette.Object.prototype.initialize=e)}).call(this);