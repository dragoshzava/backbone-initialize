(function(){var t,n,i,e=[].slice;t=function(){function t(t){this.entity=t,this.entity.addHandler=this.addHandler.bind(this),this.handlers={}}return t.prototype.handlers=null,t.prototype.entity=null,t.prototype.arrayFromString=function(t){return Array.isArray(t)?t:t.split(",").map(function(t){return t.trim()})},t.prototype.warn=function(t){return console.warn("Backbone-initialize warn: "+t)},t.prototype.getChild=function(t,n,i){var e;return null==i&&(i=this.entity),e=t.shift(),null!=i[e]?t.length?this.getChild(t,n,i[e]):i[e]:(this.warn(e+" undefined (this."+n+")"),null)},t.prototype.addHandler=function(t,n,i){var e,r,a,o,l,h,p;if(null==i&&(i=this.entity),"object"==typeof t){o=[];for(r in t)p=t[r],o.push(this.addHandler(r,p,i));return o}if("object"!=typeof n||Array.isArray(n)){if("string"==typeof n?n=this.arrayFromString(n):Array.isArray(n)||(n=[n]),"_"===t[0]&&(t=n.shift()),a=t.split("."),t=a.pop(),a.length&&!(i=this.getChild(a,a.join("."),i)))return;return n.forEach(function(n){return function(r){var a,o;if(a=!1,o=n.entity,"string"==typeof r){if(a=r,e=r.split("."),r=e.pop(),!(o=e.length?n.getChild(e,a):n.entity))return;r=o[r]}return"function"==typeof r?n.entity.listenTo(i,t,r.bind(o)):n.warn("Can't find handler for \""+t+'"'+(a?': "'+a+'"':""))}}(this))}if(e=this.getChild(t.split("."),t,i)){l=[];for(r in n)h=n[r],l.push(this.addHandler(r,h,e));return l}return this.warn("Can't append handlers to "+t+" cause child not found")},t.prototype.addHandlers=function(){if(null!=this.entity.handlers&&!this.entity.disableHandlers)return this.addHandler(this.entity.handlers)},t.prototype.launch=function(){var t,n;return t=1<=arguments.length?e.call(arguments,0):[],this.addHandlers(),(n=this.entity).trigger.apply(n,["launch"].concat(e.call(t)))},t}(),this.BackbonePrepare=n=[],i=function(){var i,r,a,o,l,h,p;if(o=1<=arguments.length?e.call(arguments,0):[],a=this.options,this instanceof Backbone.Collection&&(a=o[1]),"object"==typeof this.handlers||null!=(null!=a?a.attach:void 0)||"function"==typeof this.launch){if(this._bbInitialize=new t(this),"function"==typeof this.launch&&this.addHandler("launch",this.launch),null!=(null!=a?a.attach:void 0)){h=a.attach;for(i in h)r=h[i],this[i]=r}return n.length||Array.isArray(this.prepare)?(this.prepare||(this.prepare=[]),this.prepare=n.concat(this.prepare),l=this.prepare.map(function(t){return function(n){var i;return i="function"==typeof n?n:t[n],"function"!=typeof i&&(t._bbInitialize.warn("Prepare item "+n+" isn't function"),i=$.noop),i.apply(t,o)}}(this)),$.when.apply(null,l).then(function(t){return function(){var n;return(n=t._bbInitialize).launch.apply(n,o)}}(this))):(p=this._bbInitialize).launch.apply(p,o)}},Backbone.Model.prototype.initialize=i,Backbone.Collection.prototype.initialize=i,Backbone.View.prototype.initialize=i,null!=Backbone.Layout&&(Backbone.Layout.prototype.initialize=i),"undefined"!=typeof Marionette&&null!==Marionette&&(Marionette.Object.prototype.initialize=i)}).call(this);