(function(){var t,n,i,r=[].slice;t=function(){function t(t){this.entity=t,this.entity.addHandler=this.addHandler.bind(this),this.handlers={}}return t.prototype.handlers=null,t.prototype.entity=null,t.prototype.arrayFromString=function(t){return Array.isArray(t)?t:t.split(",").map(function(t){return t.trim()})},t.prototype.warn=function(t){return console.warn("Backbone-initialize warn: "+t)},t.prototype.getChild=function(t,n,i){var r;return null==i&&(i=this.entity),r=t.shift(),null!=i[r]?t.length?this.getChild(t,n,i[r]):i[r]:(this.warn(r+" undefined (this."+n+")"),null)},t.prototype.addHandler=function(t,n,i){var r,e,a;if(null==i&&(i=this.entity),"object"==typeof t){e=[];for(r in t)a=t[r],e.push(this.addHandler(r,a,i));return e}return"object"!=typeof n||Array.isArray(n)?("string"==typeof n&&(n=this.arrayFromString(n)),Array.isArray(n)||(n=[n]),n=n.slice(),"_"===t[0]&&(t=n.shift()),this.arrayFromString(t).forEach(function(t){return function(r){var e,a;if(e=i,a=r.split("."),r=a.pop(),!a.length||(e=t.getChild(a,a.join("."),e)))return n.forEach(function(n){var i,a,o;if(a=!1,o=t.entity,"string"==typeof n){if(a=n,i=n.split("."),n=i.pop(),!(o=i.length?t.getChild(i,a):t.entity))return;n=o[n]}return"function"==typeof n?t.entity.listenTo(e,r,n.bind(o)):t.warn("Can't find handler for \""+r+'"'+(a?': "'+a+'"':""))})}}(this))):void this.arrayFromString(t).forEach(function(t){return function(e){var a,o,l;if(a=t.getChild(e.split("."),e,i)){o=[];for(r in n)l=n[r],o.push(t.addHandler(r,l,a));return o}return t.warn("Can't append handlers to "+e+" cause child not found")}}(this))},t.prototype.addHandlers=function(){if(null!=this.entity.handlers&&!this.entity.disableHandlers)return this.addHandler(this.entity.handlers)},t.prototype.launch=function(){var t,n;return t=1<=arguments.length?r.call(arguments,0):[],this.addHandlers(),(n=this.entity).trigger.apply(n,["launch"].concat(r.call(t)))},t}(),this.BackbonePrepare=n=[],i=function(){var i,e,a,o,l,h,p;if(o=1<=arguments.length?r.call(arguments,0):[],a=this.options,this instanceof Backbone.Collection&&(a=o[1]),"object"==typeof this.handlers||null!=(null!=a?a.attach:void 0)||"function"==typeof this.launch){if(this._bbInitialize=new t(this),"function"==typeof this.launch&&this.addHandler("launch",this.launch),null!=(null!=a?a.attach:void 0)){h=a.attach;for(i in h)e=h[i],this[i]=e}return n.length||Array.isArray(this.prepare)?(this.prepare||(this.prepare=[]),this.prepare=n.concat(this.prepare),l=this.prepare.map(function(t){return function(n){var i;return i="function"==typeof n?n:t[n],"function"!=typeof i&&(t._bbInitialize.warn("Prepare item "+n+" isn't function"),i=$.noop),i.apply(t,o)}}(this)),$.when.apply(null,l).then(function(t){return function(){var n;return(n=t._bbInitialize).launch.apply(n,o)}}(this))):(p=this._bbInitialize).launch.apply(p,o)}},Backbone.Model.prototype.initialize=i,Backbone.Collection.prototype.initialize=i,Backbone.View.prototype.initialize=i,null!=Backbone.Layout&&(Backbone.Layout.prototype.initialize=i),"undefined"!=typeof Marionette&&null!==Marionette&&(Marionette.Object.prototype.initialize=i)}).call(this);